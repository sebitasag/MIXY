<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=980, initial-scale=1.0">
  <title>Login & Registro</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <div class="container" id="main-container">
    <!-- LOGIN FORM -->
    <div class="form-section" id="login-section">
      <h2>Iniciar Sesión</h2>
      <form id="login-form">
        <div class="input-box">
          <input type="email" name="loginCorreo" placeholder="Correo electrónico" required>
        </div>
        <div class="input-box">
          <input type="password" name="loginClave" placeholder="Contraseña" required>
        </div>
        <button type="submit">INGRESAR</button>
      </form>
      <a href="#">¿Olvidaste tu contraseña?</a>
    </div>
    <!-- REGISTRO FORM -->
    <div class="form-section hidden" id="registro-section">
      <h2>Registrarse</h2>
      <form id="registro-form">
        <div class="input-box">
          <input type="text" id="nombre" name="nombre" placeholder="Nombre" required>
        </div>
        <div class="input-box">
          <input type="text" id="apellido" name="apellido" placeholder="Apellido" required>
        </div>
        <div class="input-box">
          <input type="email" id="correo" name="correo" placeholder="Correo electrónico" required>
        </div>
        <div class="input-box">
          <input type="date" id="nacimiento" name="nacimiento" required>
        </div>
        <div class="input-box">
          <input type="password" id="password" name="clave" placeholder="Contraseña" required>
        </div>
        <button type="submit">REGISTRARSE</button>
      </form>
    </div>
    <!-- SLIDE PANEL -->
    <div class="slide-panel" id="slide-panel">
      <div class="slide-content" id="slide-content">
        <h3 id="slide-title">¡Bienvenido!</h3>
        <p id="slide-text">¿Eres nuevo aquí? Regístrate para usar todas las funciones del sitio.</p>
        <button id="slide-btn">Registrarse</button>
      </div>
    </div>
  </div>
  <script>

// ------------------ CAMBIO ENTRE LOGIN Y REGISTRO ------------------
const btnSlide = document.getElementById("slide-btn");
const loginSection = document.getElementById("login-section");
const registroSection = document.getElementById("registro-section");
let mostrando = "login";

btnSlide.addEventListener("click", () => {
  if (mostrando === "login") {
    loginSection.classList.add("hidden");
    registroSection.classList.remove("hidden");
    btnSlide.textContent = "Iniciar Sesión";
    mostrando = "registro";
  } else {
    registroSection.classList.add("hidden");
    loginSection.classList.remove("hidden");
    btnSlide.textContent = "Registrarse";
    mostrando = "login";
  }
});


// ------------------ REGISTRO ------------------
document.getElementById("registro-form").addEventListener("submit", async (e) => {
  e.preventDefault();

  const datos = {
    nombre: document.getElementById("nombre").value,
    apellido: document.getElementById("apellido").value,
    correo: document.getElementById("correo").value,
    nacimiento: document.getElementById("nacimiento").value,
    password: document.getElementById("password").value
  };

  const res = await fetch("/api/registro", {
    method: "POST",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify(datos)
  });

  const data = await res.json();

  if (data.ok) {
    alert("Registro exitoso.");
    registroSection.classList.add("hidden");
    loginSection.classList.remove("hidden");
    btnSlide.textContent = "Registrarse";
    mostrando = "login";
  } else {
    alert("Error registrando usuario.");
  }
});


// ------------------ LOGIN ------------------
document.getElementById("login-form").addEventListener("submit", async (e) => {
  e.preventDefault();

  const datos = {
    correo: e.target.loginCorreo.value,
    password: e.target.loginClave.value
  };

  const res = await fetch("/api/login", {
    method: "POST",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify(datos)
  });

  const data = await res.json();

  if (data.ok) {
    alert("Datos correctos ✔ Iniciando sesión...");
    window.location.href = "/dashboard.html";
  } else {
    alert("Correo o contraseña incorrectos.");
  }
});

</script>

</body>
</html>